"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/cargo/route";
exports.ids = ["app/api/cargo/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcargo%2Froute&page=%2Fapi%2Fcargo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcargo%2Froute.ts&appDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcargo%2Froute&page=%2Fapi%2Fcargo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcargo%2Froute.ts&appDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_Burak_Documents_GitHub_destek_src_app_api_cargo_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/cargo/route.ts */ \"(rsc)/./src/app/api/cargo/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/cargo/route\",\n        pathname: \"/api/cargo\",\n        filename: \"route\",\n        bundlePath: \"app/api/cargo/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\Burak\\\\Documents\\\\GitHub\\\\destek\\\\src\\\\app\\\\api\\\\cargo\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_Burak_Documents_GitHub_destek_src_app_api_cargo_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/cargo/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjYXJnbyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2FyZ28lMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjYXJnbyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNCdXJhayU1Q0RvY3VtZW50cyU1Q0dpdEh1YiU1Q2Rlc3RlayU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDQnVyYWslNUNEb2N1bWVudHMlNUNHaXRIdWIlNUNkZXN0ZWsmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzJCO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZGVzdGVrLz82OTNkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXEJ1cmFrXFxcXERvY3VtZW50c1xcXFxHaXRIdWJcXFxcZGVzdGVrXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNhcmdvXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jYXJnby9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2NhcmdvXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jYXJnby9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXEJ1cmFrXFxcXERvY3VtZW50c1xcXFxHaXRIdWJcXFxcZGVzdGVrXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGNhcmdvXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9jYXJnby9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcargo%2Froute&page=%2Fapi%2Fcargo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcargo%2Froute.ts&appDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/cargo/route.ts":
/*!************************************!*\
  !*** ./src/app/api/cargo/route.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_cargo_repair__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/cargo-repair */ \"(rsc)/./src/lib/cargo-repair.ts\");\n\n\n\n\nconst DEFAULT_HQ_NAME = \"Merkez Ofis Deposu\";\nfunction isUnknownRecordStatusArg(error) {\n    if (!(error instanceof Error)) return false;\n    return error.message.includes(\"Unknown argument `recordStatus`\") || error.message.includes(\"record_status\");\n}\nfunction normalizeRecordStatus(status, notes) {\n    const raw = typeof status === \"string\" ? status.toLowerCase() : \"open\";\n    const { meta } = (0,_lib_cargo_repair__WEBPACK_IMPORTED_MODULE_3__.parseCargoRepairMeta)(notes);\n    if (meta?.active) return \"device_repair\";\n    return raw;\n}\nasync function getHeadquartersLocation() {\n    const hq = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.location.findFirst({\n        where: {\n            OR: [\n                {\n                    type: \"HEADQUARTERS\"\n                },\n                {\n                    name: {\n                        contains: \"Merkez\"\n                    }\n                },\n                {\n                    name: {\n                        contains: \"Ofis\"\n                    }\n                }\n            ],\n            active: true\n        },\n        orderBy: {\n            name: \"asc\"\n        }\n    });\n    return hq;\n}\n// GET all cargo trackings\nasync function GET(request) {\n    try {\n        const headquarters = await getHeadquartersLocation();\n        const hqName = headquarters?.name || DEFAULT_HQ_NAME;\n        let cargos = [];\n        try {\n            cargos = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cargoTracking.findMany({\n                include: {\n                    devices: true\n                },\n                orderBy: [\n                    {\n                        recordStatus: \"asc\"\n                    },\n                    {\n                        createdAt: \"desc\"\n                    }\n                ]\n            });\n        } catch (error) {\n            if (!isUnknownRecordStatusArg(error)) throw error;\n            cargos = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cargoTracking.findMany({\n                include: {\n                    devices: true\n                },\n                orderBy: {\n                    createdAt: \"desc\"\n                }\n            });\n        }\n        const enriched = await Promise.all(cargos.map(async (cargo)=>{\n            // Varsayılan ofis ismi\n            let locationName = cargo.type === \"INCOMING\" ? hqName : null;\n            // Eğer kargo cihaz içeriyorsa, bu cihazların güncel konumuna bakalım\n            if (cargo.devices && cargo.devices.length > 0) {\n                const serials = cargo.devices.map((d)=>d.serialNumber).filter((s)=>Boolean(s));\n                if (serials.length > 0) {\n                    // Bu seri numaralarına sahip cihazların güncel konumlarını bulalım\n                    const devicesInSystem = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.equivalentDevice.findMany({\n                        where: {\n                            serialNumber: {\n                                in: serials\n                            }\n                        },\n                        include: {\n                            location: true\n                        }\n                    });\n                    // Cihazların bulunduğu benzersiz konumları topla\n                    const locations = new Set();\n                    devicesInSystem.forEach((d)=>{\n                        if (d.location && d.location.name) {\n                            locations.add(d.location.name);\n                        } else if (d.currentLocation === \"ON_SITE_SERVICE\") {\n                            locations.add(\"Sahada / M\\xfcşteride\");\n                        } else if (d.currentLocation === \"AT_CUSTOMER\") {\n                            locations.add(\"M\\xfcşteride\");\n                        }\n                    });\n                    if (locations.size === 1) {\n                        locationName = Array.from(locations)[0];\n                    } else if (locations.size > 1) {\n                        locationName = \"Muhtelif / Dağıtılmış\";\n                    }\n                // locations.size === 0 ise (henüz envantere girmemiş veya eşleşmemiş), varsayılanı koru\n                }\n            }\n            return {\n                ...cargo,\n                recordStatus: normalizeRecordStatus(cargo.recordStatus, cargo.notes),\n                currentLocationName: locationName\n            };\n        }));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(enriched);\n    } catch (error) {\n        console.error(\"Error fetching cargo:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch cargo\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST create new cargo\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { trackingNumber, type, status, recordStatus, sender, receiver, cargoCompany, sentDate, deliveredDate, destination, destinationAddress, notes, devices } = body;\n        // Map enum values\n        const typeMap = {\n            \"incoming\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.INCOMING,\n            \"outgoing\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.OUTGOING,\n            \"on_site_service\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.ON_SITE_SERVICE,\n            \"installation_team\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.INSTALLATION_TEAM\n        };\n        const statusMap = {\n            \"in_transit\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.IN_TRANSIT,\n            \"delivered\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.DELIVERED,\n            \"returned\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.RETURNED,\n            \"lost\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.LOST,\n            \"damaged\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.DAMAGED\n        };\n        const destinationMap = {\n            \"customer\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.CUSTOMER,\n            \"distributor\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.DISTRIBUTOR,\n            \"branch\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.BRANCH,\n            \"headquarters\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.HEADQUARTERS\n        };\n        const conditionMap = {\n            \"new\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.DeviceCondition.NEW,\n            \"used\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.DeviceCondition.USED,\n            \"refurbished\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.DeviceCondition.REFURBISHED,\n            \"damaged\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.DeviceCondition.DAMAGED\n        };\n        const purposeMap = {\n            \"installation\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoPurpose.INSTALLATION,\n            \"replacement\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoPurpose.REPLACEMENT,\n            \"repair\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoPurpose.REPAIR,\n            \"return\": _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoPurpose.RETURN\n        };\n        const recordStatusMap = {\n            \"open\": \"OPEN\",\n            \"on_hold\": \"ON_HOLD\",\n            \"closed\": \"CLOSED\",\n            \"device_repair\": \"ON_HOLD\"\n        };\n        const normalizedTrackingNumber = String(trackingNumber || \"\").trim();\n        if (!normalizedTrackingNumber) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Takip numarasi zorunludur.\"\n            }, {\n                status: 400\n            });\n        }\n        const existingCargo = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cargoTracking.findUnique({\n            where: {\n                trackingNumber: normalizedTrackingNumber\n            },\n            select: {\n                id: true\n            }\n        });\n        if (existingCargo) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Bu takip numarasi zaten kayitli. Lutfen farkli bir takip numarasi girin.\"\n            }, {\n                status: 409\n            });\n        }\n        const deviceList = Array.isArray(devices) ? devices : [];\n        const resolvedType = typeMap[type?.toLowerCase()] || _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.OUTGOING;\n        const isIncoming = resolvedType === _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.INCOMING;\n        const createData = {\n            trackingNumber: normalizedTrackingNumber,\n            type: resolvedType,\n            status: statusMap[status?.toLowerCase()] || _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoStatus.IN_TRANSIT,\n            sender,\n            receiver,\n            cargoCompany: cargoCompany || \"\",\n            sentDate: sentDate ? new Date(sentDate) : null,\n            deliveredDate: deliveredDate ? new Date(deliveredDate) : null,\n            destination: isIncoming ? _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.HEADQUARTERS : destinationMap[destination?.toLowerCase()] || _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoDestination.CUSTOMER,\n            destinationAddress: isIncoming ? typeof destinationAddress === \"string\" && destinationAddress.trim() ? destinationAddress : DEFAULT_HQ_NAME : destinationAddress,\n            notes,\n            devices: {\n                create: deviceList.map((device)=>({\n                        deviceName: device.deviceName,\n                        model: device.model,\n                        serialNumber: device.serialNumber,\n                        quantity: device.quantity || 1,\n                        condition: conditionMap[device.condition?.toLowerCase()] || _prisma_client__WEBPACK_IMPORTED_MODULE_2__.DeviceCondition.NEW,\n                        purpose: purposeMap[device.purpose?.toLowerCase()] || _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoPurpose.INSTALLATION\n                    }))\n            }\n        };\n        if (typeof recordStatus === \"string\") {\n            const mappedStatus = recordStatusMap[recordStatus.toLowerCase()];\n            if (mappedStatus) {\n                createData.recordStatus = mappedStatus;\n            }\n        }\n        if (String(recordStatus || \"\").toLowerCase() === \"device_repair\") {\n            createData.notes = (0,_lib_cargo_repair__WEBPACK_IMPORTED_MODULE_3__.appendCargoRepairHistory)(typeof notes === \"string\" ? notes : \"\", {\n                at: new Date().toISOString(),\n                action: \"Kargo kaydi cihaz tamiri durumunda olusturuldu\"\n            }, {\n                active: true,\n                status: \"pending\"\n            });\n        }\n        let cargo;\n        try {\n            cargo = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cargoTracking.create({\n                data: createData,\n                include: {\n                    devices: true\n                }\n            });\n        } catch (error) {\n            if (!isUnknownRecordStatusArg(error)) throw error;\n            delete createData.recordStatus;\n            cargo = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.cargoTracking.create({\n                data: createData,\n                include: {\n                    devices: true\n                }\n            });\n        }\n        // --- AUTOMATIC WAREHOUSE ASSIGNMENT FOR INCOMING CARGO ---\n        if (resolvedType === _prisma_client__WEBPACK_IMPORTED_MODULE_2__.CargoType.INCOMING) {\n            try {\n                let targetLocation;\n                // 1. Determine Target Location\n                if (body.targetLocationId) {\n                    targetLocation = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.location.findUnique({\n                        where: {\n                            id: body.targetLocationId\n                        }\n                    });\n                }\n                // Fallback to \"Office\" if no target selected or not found\n                if (!targetLocation) {\n                    targetLocation = await getHeadquartersLocation();\n                    if (!targetLocation) {\n                        targetLocation = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.location.create({\n                            data: {\n                                name: DEFAULT_HQ_NAME,\n                                type: \"HEADQUARTERS\",\n                                address: \"Otomatik Oluşturuldu\",\n                                active: true\n                            }\n                        });\n                    }\n                }\n                // 2. Process only predefined equivalent devices\n                let movedEquivalentCount = 0;\n                let skippedNonEquivalentCount = 0;\n                for (const device of deviceList){\n                    const sourceType = String(device?.sourceType || \"\").toLowerCase();\n                    if (sourceType !== \"equivalent\") {\n                        skippedNonEquivalentCount++;\n                        continue;\n                    }\n                    if (!device.serialNumber || device.serialNumber.length < 3) continue;\n                    let existingDevice = null;\n                    if (device.equivalentDeviceId) {\n                        existingDevice = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.equivalentDevice.findUnique({\n                            where: {\n                                id: device.equivalentDeviceId\n                            }\n                        });\n                    }\n                    if (!existingDevice) {\n                        existingDevice = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.equivalentDevice.findUnique({\n                            where: {\n                                serialNumber: device.serialNumber\n                            }\n                        });\n                    }\n                    if (existingDevice) {\n                        // Update existing device location\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.equivalentDevice.update({\n                            where: {\n                                id: existingDevice.id\n                            },\n                            data: {\n                                location: {\n                                    connect: {\n                                        id: targetLocation.id\n                                    }\n                                },\n                                currentLocation: \"IN_WAREHOUSE\",\n                                status: \"AVAILABLE\"\n                            }\n                        });\n                        // Track History\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.equivalentDeviceHistory.create({\n                            data: {\n                                device: {\n                                    connect: {\n                                        id: existingDevice.id\n                                    }\n                                },\n                                previousLocation: existingDevice.currentLocation,\n                                newLocation: \"IN_WAREHOUSE\",\n                                previousLocationId: existingDevice.locationId,\n                                newLocationId: targetLocation.id,\n                                assignedToName: `Kargo ile Giriş (${trackingNumber})`,\n                                notes: `Gelen Kargo: ${trackingNumber} - Gönderen: ${sender} - Depo: ${targetLocation.name}`,\n                                changedBy: \"SYSTEM\",\n                                changedByName: \"Sistem (Otomatik Kargo Girişi)\"\n                            }\n                        });\n                        movedEquivalentCount++;\n                    } else {\n                        skippedNonEquivalentCount++;\n                    }\n                }\n                if (movedEquivalentCount > 0 || skippedNonEquivalentCount > 0) {\n                    console.log(`[cargo-incoming] tracking=${trackingNumber} movedEquivalent=${movedEquivalentCount} skipped=${skippedNonEquivalentCount}`);\n                }\n            } catch (err) {\n                console.error(\"Error auto-assigning incoming cargo to warehouse:\", err);\n            // Don't fail the request, just log error\n            }\n        }\n        // ---------------------------------------------------------\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(cargo, {\n            status: 201\n        });\n    } catch (error) {\n        const p2002Target = error instanceof _prisma_client__WEBPACK_IMPORTED_MODULE_2__.Prisma.PrismaClientKnownRequestError ? error.meta?.target : null;\n        const targetText = Array.isArray(p2002Target) ? p2002Target.join(\",\") : String(p2002Target || \"\");\n        if (error instanceof _prisma_client__WEBPACK_IMPORTED_MODULE_2__.Prisma.PrismaClientKnownRequestError && error.code === \"P2002\" && (targetText.includes(\"tracking_number\") || targetText.includes(\"trackingNumber\"))) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Bu takip numarasi zaten kayitli. Lutfen farkli bir takip numarasi girin.\"\n            }, {\n                status: 409\n            });\n        }\n        console.error(\"Error creating cargo:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to create cargo\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUssUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZXN0ZWsvLi9zcmMvYXBwL2FwaS9jYXJnby9yb3V0ZS50cz81Y2IyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi4vLi4vLi4vbGliL3ByaXNtYSdcbmltcG9ydCB7IENhcmdvVHlwZSwgQ2FyZ29TdGF0dXMsIENhcmdvRGVzdGluYXRpb24sIERldmljZUNvbmRpdGlvbiwgQ2FyZ29QdXJwb3NlLCBQcmlzbWEgfSBmcm9tICdAcHJpc21hL2NsaWVudCdcbmltcG9ydCB7IGFwcGVuZENhcmdvUmVwYWlySGlzdG9yeSwgcGFyc2VDYXJnb1JlcGFpck1ldGEgfSBmcm9tICdAL2xpYi9jYXJnby1yZXBhaXInXG5cclxuY29uc3QgREVGQVVMVF9IUV9OQU1FID0gJ01lcmtleiBPZmlzIERlcG9zdSdcblxuZnVuY3Rpb24gaXNVbmtub3duUmVjb3JkU3RhdHVzQXJnKGVycm9yOiB1bmtub3duKSB7XG4gIGlmICghKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpKSByZXR1cm4gZmFsc2VcbiAgcmV0dXJuIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ1Vua25vd24gYXJndW1lbnQgYHJlY29yZFN0YXR1c2AnKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdyZWNvcmRfc3RhdHVzJylcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplUmVjb3JkU3RhdHVzKHN0YXR1czogc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCwgbm90ZXM/OiBzdHJpbmcgfCBudWxsKSB7XG4gIGNvbnN0IHJhdyA9IHR5cGVvZiBzdGF0dXMgPT09ICdzdHJpbmcnID8gc3RhdHVzLnRvTG93ZXJDYXNlKCkgOiAnb3BlbidcbiAgY29uc3QgeyBtZXRhIH0gPSBwYXJzZUNhcmdvUmVwYWlyTWV0YShub3RlcylcbiAgaWYgKG1ldGE/LmFjdGl2ZSkgcmV0dXJuICdkZXZpY2VfcmVwYWlyJ1xuICByZXR1cm4gcmF3XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEhlYWRxdWFydGVyc0xvY2F0aW9uKCkge1xuICBjb25zdCBocSA9IGF3YWl0IHByaXNtYS5sb2NhdGlvbi5maW5kRmlyc3Qoe1xyXG4gICAgd2hlcmU6IHtcclxuICAgICAgT1I6IFtcclxuICAgICAgICB7IHR5cGU6ICdIRUFEUVVBUlRFUlMnIH0sXHJcbiAgICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiAnTWVya2V6JyB9IH0sXHJcbiAgICAgICAgeyBuYW1lOiB7IGNvbnRhaW5zOiAnT2ZpcycgfSB9LFxyXG4gICAgICBdLFxyXG4gICAgICBhY3RpdmU6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgb3JkZXJCeTogeyBuYW1lOiAnYXNjJyB9LFxyXG4gIH0pXHJcblxyXG4gIHJldHVybiBocVxyXG59XHJcblxyXG4vLyBHRVQgYWxsIGNhcmdvIHRyYWNraW5nc1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XHJcbiAgICBjb25zdCBoZWFkcXVhcnRlcnMgPSBhd2FpdCBnZXRIZWFkcXVhcnRlcnNMb2NhdGlvbigpXHJcbiAgICBjb25zdCBocU5hbWUgPSBoZWFkcXVhcnRlcnM/Lm5hbWUgfHwgREVGQVVMVF9IUV9OQU1FXHJcblxyXG4gICAgbGV0IGNhcmdvczogYW55W10gPSBbXVxuICAgIHRyeSB7XG4gICAgICBjYXJnb3MgPSBhd2FpdCAocHJpc21hLmNhcmdvVHJhY2tpbmcgYXMgYW55KS5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBkZXZpY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiBbXG4gICAgICAgICAgeyByZWNvcmRTdGF0dXM6ICdhc2MnIH0sXG4gICAgICAgICAgeyBjcmVhdGVkQXQ6ICdkZXNjJyB9LFxuICAgICAgICBdLFxuICAgICAgfSlcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKCFpc1Vua25vd25SZWNvcmRTdGF0dXNBcmcoZXJyb3IpKSB0aHJvdyBlcnJvclxuXG4gICAgICBjYXJnb3MgPSBhd2FpdCBwcmlzbWEuY2FyZ29UcmFja2luZy5maW5kTWFueSh7XG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBkZXZpY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7XG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYycsXG4gICAgICAgIH0sXG4gICAgICB9KVxuICAgIH1cblxyXG4gICAgY29uc3QgZW5yaWNoZWQgPSBhd2FpdCBQcm9taXNlLmFsbChjYXJnb3MubWFwKGFzeW5jIChjYXJnbykgPT4ge1xyXG4gICAgICAvLyBWYXJzYXnEsWxhbiBvZmlzIGlzbWlcclxuICAgICAgbGV0IGxvY2F0aW9uTmFtZSA9IGNhcmdvLnR5cGUgPT09ICdJTkNPTUlORycgPyBocU5hbWUgOiBudWxsO1xyXG5cclxuICAgICAgLy8gRcSfZXIga2FyZ28gY2loYXogacOnZXJpeW9yc2EsIGJ1IGNpaGF6bGFyxLFuIGfDvG5jZWwga29udW11bmEgYmFrYWzEsW1cclxuICAgICAgaWYgKGNhcmdvLmRldmljZXMgJiYgY2FyZ28uZGV2aWNlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBzZXJpYWxzID0gY2FyZ28uZGV2aWNlc1xuICAgICAgICAgICAgLm1hcCgoZDogYW55KSA9PiBkLnNlcmlhbE51bWJlcilcbiAgICAgICAgICAgIC5maWx0ZXIoKHM6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQpOiBzIGlzIHN0cmluZyA9PiBCb29sZWFuKHMpKTtcblxyXG4gICAgICAgIGlmIChzZXJpYWxzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vIEJ1IHNlcmkgbnVtYXJhbGFyxLFuYSBzYWhpcCBjaWhhemxhcsSxbiBnw7xuY2VsIGtvbnVtbGFyxLFuxLEgYnVsYWzEsW1cclxuICAgICAgICAgIGNvbnN0IGRldmljZXNJblN5c3RlbSA9IGF3YWl0IHByaXNtYS5lcXVpdmFsZW50RGV2aWNlLmZpbmRNYW55KHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgc2VyaWFsTnVtYmVyOiB7IGluOiBzZXJpYWxzIH0gfSxcclxuICAgICAgICAgICAgaW5jbHVkZTogeyBsb2NhdGlvbjogdHJ1ZSB9XHJcbiAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAvLyBDaWhhemxhcsSxbiBidWx1bmR1xJ91IGJlbnplcnNpeiBrb251bWxhcsSxIHRvcGxhXHJcbiAgICAgICAgICBjb25zdCBsb2NhdGlvbnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICAgICAgICAgIGRldmljZXNJblN5c3RlbS5mb3JFYWNoKGQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZC5sb2NhdGlvbiAmJiBkLmxvY2F0aW9uLm5hbWUpIHtcclxuICAgICAgICAgICAgICBsb2NhdGlvbnMuYWRkKGQubG9jYXRpb24ubmFtZSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZC5jdXJyZW50TG9jYXRpb24gPT09ICdPTl9TSVRFX1NFUlZJQ0UnKSB7XHJcbiAgICAgICAgICAgICAgbG9jYXRpb25zLmFkZCgnU2FoYWRhIC8gTcO8xZ90ZXJpZGUnKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChkLmN1cnJlbnRMb2NhdGlvbiA9PT0gJ0FUX0NVU1RPTUVSJykge1xyXG4gICAgICAgICAgICAgIGxvY2F0aW9ucy5hZGQoJ03DvMWfdGVyaWRlJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIGlmIChsb2NhdGlvbnMuc2l6ZSA9PT0gMSkge1xyXG4gICAgICAgICAgICBsb2NhdGlvbk5hbWUgPSBBcnJheS5mcm9tKGxvY2F0aW9ucylbMF07XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGxvY2F0aW9ucy5zaXplID4gMSkge1xyXG4gICAgICAgICAgICBsb2NhdGlvbk5hbWUgPSAnTXVodGVsaWYgLyBEYcSfxLF0xLFsbcSxxZ8nO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgLy8gbG9jYXRpb25zLnNpemUgPT09IDAgaXNlIChoZW7DvHogZW52YW50ZXJlIGdpcm1lbWnFnyB2ZXlhIGXFn2xlxZ9tZW1pxZ8pLCB2YXJzYXnEsWxhbsSxIGtvcnVcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmNhcmdvLFxuICAgICAgICByZWNvcmRTdGF0dXM6IG5vcm1hbGl6ZVJlY29yZFN0YXR1cyhjYXJnby5yZWNvcmRTdGF0dXMsIGNhcmdvLm5vdGVzKSxcbiAgICAgICAgY3VycmVudExvY2F0aW9uTmFtZTogbG9jYXRpb25OYW1lLFxuICAgICAgfTtcbiAgICB9KSk7XG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihlbnJpY2hlZClcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY2FyZ286JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggY2FyZ28nIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH1cclxufVxyXG5cclxuLy8gUE9TVCBjcmVhdGUgbmV3IGNhcmdvXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3Qge1xuICAgICAgdHJhY2tpbmdOdW1iZXIsXG4gICAgICB0eXBlLFxuICAgICAgc3RhdHVzLFxuICAgICAgcmVjb3JkU3RhdHVzLFxuICAgICAgc2VuZGVyLFxuICAgICAgcmVjZWl2ZXIsXG4gICAgICBjYXJnb0NvbXBhbnksXG4gICAgICBzZW50RGF0ZSxcclxuICAgICAgZGVsaXZlcmVkRGF0ZSxcclxuICAgICAgZGVzdGluYXRpb24sXHJcbiAgICAgIGRlc3RpbmF0aW9uQWRkcmVzcyxcclxuICAgICAgbm90ZXMsXHJcbiAgICAgIGRldmljZXMsXHJcbiAgICB9ID0gYm9keVxyXG5cclxuICAgIC8vIE1hcCBlbnVtIHZhbHVlc1xyXG4gICAgY29uc3QgdHlwZU1hcDogeyBba2V5OiBzdHJpbmddOiBDYXJnb1R5cGUgfSA9IHtcbiAgICAgICdpbmNvbWluZyc6IENhcmdvVHlwZS5JTkNPTUlORyxcbiAgICAgICdvdXRnb2luZyc6IENhcmdvVHlwZS5PVVRHT0lORyxcbiAgICAgICdvbl9zaXRlX3NlcnZpY2UnOiBDYXJnb1R5cGUuT05fU0lURV9TRVJWSUNFLFxuICAgICAgJ2luc3RhbGxhdGlvbl90ZWFtJzogQ2FyZ29UeXBlLklOU1RBTExBVElPTl9URUFNLFxuICAgIH1cblxyXG4gICAgY29uc3Qgc3RhdHVzTWFwOiB7IFtrZXk6IHN0cmluZ106IENhcmdvU3RhdHVzIH0gPSB7XG4gICAgICAnaW5fdHJhbnNpdCc6IENhcmdvU3RhdHVzLklOX1RSQU5TSVQsXHJcbiAgICAgICdkZWxpdmVyZWQnOiBDYXJnb1N0YXR1cy5ERUxJVkVSRUQsXHJcbiAgICAgICdyZXR1cm5lZCc6IENhcmdvU3RhdHVzLlJFVFVSTkVELFxyXG4gICAgICAnbG9zdCc6IENhcmdvU3RhdHVzLkxPU1QsXHJcbiAgICAgICdkYW1hZ2VkJzogQ2FyZ29TdGF0dXMuREFNQUdFRCxcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkZXN0aW5hdGlvbk1hcDogeyBba2V5OiBzdHJpbmddOiBDYXJnb0Rlc3RpbmF0aW9uIH0gPSB7XG4gICAgICAnY3VzdG9tZXInOiBDYXJnb0Rlc3RpbmF0aW9uLkNVU1RPTUVSLFxyXG4gICAgICAnZGlzdHJpYnV0b3InOiBDYXJnb0Rlc3RpbmF0aW9uLkRJU1RSSUJVVE9SLFxyXG4gICAgICAnYnJhbmNoJzogQ2FyZ29EZXN0aW5hdGlvbi5CUkFOQ0gsXHJcbiAgICAgICdoZWFkcXVhcnRlcnMnOiBDYXJnb0Rlc3RpbmF0aW9uLkhFQURRVUFSVEVSUyxcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjb25kaXRpb25NYXA6IHsgW2tleTogc3RyaW5nXTogRGV2aWNlQ29uZGl0aW9uIH0gPSB7XHJcbiAgICAgICduZXcnOiBEZXZpY2VDb25kaXRpb24uTkVXLFxyXG4gICAgICAndXNlZCc6IERldmljZUNvbmRpdGlvbi5VU0VELFxyXG4gICAgICAncmVmdXJiaXNoZWQnOiBEZXZpY2VDb25kaXRpb24uUkVGVVJCSVNIRUQsXHJcbiAgICAgICdkYW1hZ2VkJzogRGV2aWNlQ29uZGl0aW9uLkRBTUFHRUQsXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgcHVycG9zZU1hcDogeyBba2V5OiBzdHJpbmddOiBDYXJnb1B1cnBvc2UgfSA9IHtcbiAgICAgICdpbnN0YWxsYXRpb24nOiBDYXJnb1B1cnBvc2UuSU5TVEFMTEFUSU9OLFxuICAgICAgJ3JlcGxhY2VtZW50JzogQ2FyZ29QdXJwb3NlLlJFUExBQ0VNRU5ULFxuICAgICAgJ3JlcGFpcic6IENhcmdvUHVycG9zZS5SRVBBSVIsXG4gICAgICAncmV0dXJuJzogQ2FyZ29QdXJwb3NlLlJFVFVSTixcbiAgICB9XG5cbiAgICBjb25zdCByZWNvcmRTdGF0dXNNYXA6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICAnb3Blbic6ICdPUEVOJyxcbiAgICAgICdvbl9ob2xkJzogJ09OX0hPTEQnLFxuICAgICAgJ2Nsb3NlZCc6ICdDTE9TRUQnLFxuICAgICAgJ2RldmljZV9yZXBhaXInOiAnT05fSE9MRCcsXG4gICAgfVxuXHJcbiAgICBjb25zdCBub3JtYWxpemVkVHJhY2tpbmdOdW1iZXIgPSBTdHJpbmcodHJhY2tpbmdOdW1iZXIgfHwgJycpLnRyaW0oKVxuICAgIGlmICghbm9ybWFsaXplZFRyYWNraW5nTnVtYmVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdUYWtpcCBudW1hcmFzaSB6b3J1bmx1ZHVyLicgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgZXhpc3RpbmdDYXJnbyA9IGF3YWl0IHByaXNtYS5jYXJnb1RyYWNraW5nLmZpbmRVbmlxdWUoe1xuICAgICAgd2hlcmU6IHsgdHJhY2tpbmdOdW1iZXI6IG5vcm1hbGl6ZWRUcmFja2luZ051bWJlciB9LFxuICAgICAgc2VsZWN0OiB7IGlkOiB0cnVlIH0sXG4gICAgfSlcblxuICAgIGlmIChleGlzdGluZ0NhcmdvKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdCdSB0YWtpcCBudW1hcmFzaSB6YXRlbiBrYXlpdGxpLiBMdXRmZW4gZmFya2xpIGJpciB0YWtpcCBudW1hcmFzaSBnaXJpbi4nIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDkgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IGRldmljZUxpc3QgPSBBcnJheS5pc0FycmF5KGRldmljZXMpID8gZGV2aWNlcyA6IFtdXG5cbiAgICBjb25zdCByZXNvbHZlZFR5cGUgPSB0eXBlTWFwW3R5cGU/LnRvTG93ZXJDYXNlKCldIHx8IENhcmdvVHlwZS5PVVRHT0lOR1xuICAgIGNvbnN0IGlzSW5jb21pbmcgPSByZXNvbHZlZFR5cGUgPT09IENhcmdvVHlwZS5JTkNPTUlOR1xuXG4gICAgY29uc3QgY3JlYXRlRGF0YTogYW55ID0ge1xuICAgICAgdHJhY2tpbmdOdW1iZXI6IG5vcm1hbGl6ZWRUcmFja2luZ051bWJlcixcbiAgICAgIHR5cGU6IHJlc29sdmVkVHlwZSxcbiAgICAgIHN0YXR1czogc3RhdHVzTWFwW3N0YXR1cz8udG9Mb3dlckNhc2UoKV0gfHwgQ2FyZ29TdGF0dXMuSU5fVFJBTlNJVCxcbiAgICAgIHNlbmRlcixcbiAgICAgIHJlY2VpdmVyLFxuICAgICAgY2FyZ29Db21wYW55OiBjYXJnb0NvbXBhbnkgfHwgJycsXG4gICAgICBzZW50RGF0ZTogc2VudERhdGUgPyBuZXcgRGF0ZShzZW50RGF0ZSkgOiBudWxsLFxuICAgICAgZGVsaXZlcmVkRGF0ZTogZGVsaXZlcmVkRGF0ZSA/IG5ldyBEYXRlKGRlbGl2ZXJlZERhdGUpIDogbnVsbCxcbiAgICAgIGRlc3RpbmF0aW9uOiBpc0luY29taW5nXG4gICAgICAgID8gQ2FyZ29EZXN0aW5hdGlvbi5IRUFEUVVBUlRFUlNcbiAgICAgICAgOiAoZGVzdGluYXRpb25NYXBbZGVzdGluYXRpb24/LnRvTG93ZXJDYXNlKCldIHx8IENhcmdvRGVzdGluYXRpb24uQ1VTVE9NRVIpLFxuICAgICAgZGVzdGluYXRpb25BZGRyZXNzOiBpc0luY29taW5nXG4gICAgICAgID8gKHR5cGVvZiBkZXN0aW5hdGlvbkFkZHJlc3MgPT09ICdzdHJpbmcnICYmIGRlc3RpbmF0aW9uQWRkcmVzcy50cmltKCkgPyBkZXN0aW5hdGlvbkFkZHJlc3MgOiBERUZBVUxUX0hRX05BTUUpXG4gICAgICAgIDogZGVzdGluYXRpb25BZGRyZXNzLFxuICAgICAgbm90ZXMsXG4gICAgICBkZXZpY2VzOiB7XG4gICAgICAgIGNyZWF0ZTogZGV2aWNlTGlzdC5tYXAoKGRldmljZTogYW55KSA9PiAoe1xuICAgICAgICAgIGRldmljZU5hbWU6IGRldmljZS5kZXZpY2VOYW1lLFxuICAgICAgICAgIG1vZGVsOiBkZXZpY2UubW9kZWwsXG4gICAgICAgICAgc2VyaWFsTnVtYmVyOiBkZXZpY2Uuc2VyaWFsTnVtYmVyLFxuICAgICAgICAgIHF1YW50aXR5OiBkZXZpY2UucXVhbnRpdHkgfHwgMSxcbiAgICAgICAgICBjb25kaXRpb246IGNvbmRpdGlvbk1hcFtkZXZpY2UuY29uZGl0aW9uPy50b0xvd2VyQ2FzZSgpXSB8fCBEZXZpY2VDb25kaXRpb24uTkVXLFxuICAgICAgICAgIHB1cnBvc2U6IHB1cnBvc2VNYXBbZGV2aWNlLnB1cnBvc2U/LnRvTG93ZXJDYXNlKCldIHx8IENhcmdvUHVycG9zZS5JTlNUQUxMQVRJT04sXG4gICAgICAgIH0pKSxcbiAgICAgIH0sXG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiByZWNvcmRTdGF0dXMgPT09ICdzdHJpbmcnKSB7XG4gICAgICBjb25zdCBtYXBwZWRTdGF0dXMgPSByZWNvcmRTdGF0dXNNYXBbcmVjb3JkU3RhdHVzLnRvTG93ZXJDYXNlKCldXG4gICAgICBpZiAobWFwcGVkU3RhdHVzKSB7XG4gICAgICAgIGNyZWF0ZURhdGEucmVjb3JkU3RhdHVzID0gbWFwcGVkU3RhdHVzXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKFN0cmluZyhyZWNvcmRTdGF0dXMgfHwgJycpLnRvTG93ZXJDYXNlKCkgPT09ICdkZXZpY2VfcmVwYWlyJykge1xuICAgICAgY3JlYXRlRGF0YS5ub3RlcyA9IGFwcGVuZENhcmdvUmVwYWlySGlzdG9yeShcbiAgICAgICAgdHlwZW9mIG5vdGVzID09PSAnc3RyaW5nJyA/IG5vdGVzIDogJycsXG4gICAgICAgIHtcbiAgICAgICAgICBhdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgIGFjdGlvbjogJ0thcmdvIGtheWRpIGNpaGF6IHRhbWlyaSBkdXJ1bXVuZGEgb2x1c3R1cnVsZHUnLFxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICAgIHN0YXR1czogJ3BlbmRpbmcnLFxuICAgICAgICB9XG4gICAgICApXG4gICAgfVxuXG4gICAgbGV0IGNhcmdvOiBhbnlcbiAgICB0cnkge1xuICAgICAgY2FyZ28gPSBhd2FpdCAocHJpc21hLmNhcmdvVHJhY2tpbmcgYXMgYW55KS5jcmVhdGUoe1xuICAgICAgICBkYXRhOiBjcmVhdGVEYXRhLFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgZGV2aWNlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmICghaXNVbmtub3duUmVjb3JkU3RhdHVzQXJnKGVycm9yKSkgdGhyb3cgZXJyb3JcblxuICAgICAgZGVsZXRlIGNyZWF0ZURhdGEucmVjb3JkU3RhdHVzXG4gICAgICBjYXJnbyA9IGF3YWl0IHByaXNtYS5jYXJnb1RyYWNraW5nLmNyZWF0ZSh7XG4gICAgICAgIGRhdGE6IGNyZWF0ZURhdGEsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICBkZXZpY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSlcbiAgICB9XG5cclxuICAgIC8vIC0tLSBBVVRPTUFUSUMgV0FSRUhPVVNFIEFTU0lHTk1FTlQgRk9SIElOQ09NSU5HIENBUkdPIC0tLVxyXG4gICAgaWYgKHJlc29sdmVkVHlwZSA9PT0gQ2FyZ29UeXBlLklOQ09NSU5HKSB7XG4gICAgICB0cnkge1xyXG4gICAgICAgIGxldCB0YXJnZXRMb2NhdGlvbjtcclxuXHJcbiAgICAgICAgLy8gMS4gRGV0ZXJtaW5lIFRhcmdldCBMb2NhdGlvblxyXG4gICAgICAgIGlmIChib2R5LnRhcmdldExvY2F0aW9uSWQpIHtcclxuICAgICAgICAgIHRhcmdldExvY2F0aW9uID0gYXdhaXQgcHJpc21hLmxvY2F0aW9uLmZpbmRVbmlxdWUoe1xyXG4gICAgICAgICAgICB3aGVyZTogeyBpZDogYm9keS50YXJnZXRMb2NhdGlvbklkIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRmFsbGJhY2sgdG8gXCJPZmZpY2VcIiBpZiBubyB0YXJnZXQgc2VsZWN0ZWQgb3Igbm90IGZvdW5kXHJcbiAgICAgICAgaWYgKCF0YXJnZXRMb2NhdGlvbikge1xyXG4gICAgICAgICAgdGFyZ2V0TG9jYXRpb24gPSBhd2FpdCBnZXRIZWFkcXVhcnRlcnNMb2NhdGlvbigpO1xyXG4gICAgICAgICAgaWYgKCF0YXJnZXRMb2NhdGlvbikge1xyXG4gICAgICAgICAgICB0YXJnZXRMb2NhdGlvbiA9IGF3YWl0IHByaXNtYS5sb2NhdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IERFRkFVTFRfSFFfTkFNRSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdIRUFEUVVBUlRFUlMnLFxyXG4gICAgICAgICAgICAgICAgYWRkcmVzczogJ090b21hdGlrIE9sdcWfdHVydWxkdScsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRydWUsXHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gMi4gUHJvY2VzcyBvbmx5IHByZWRlZmluZWQgZXF1aXZhbGVudCBkZXZpY2VzXG4gICAgICAgIGxldCBtb3ZlZEVxdWl2YWxlbnRDb3VudCA9IDBcbiAgICAgICAgbGV0IHNraXBwZWROb25FcXVpdmFsZW50Q291bnQgPSAwXG5cbiAgICAgICAgZm9yIChjb25zdCBkZXZpY2Ugb2YgZGV2aWNlTGlzdCkge1xuICAgICAgICAgIGNvbnN0IHNvdXJjZVR5cGUgPSBTdHJpbmcoZGV2aWNlPy5zb3VyY2VUeXBlIHx8ICcnKS50b0xvd2VyQ2FzZSgpXG4gICAgICAgICAgaWYgKHNvdXJjZVR5cGUgIT09ICdlcXVpdmFsZW50Jykge1xuICAgICAgICAgICAgc2tpcHBlZE5vbkVxdWl2YWxlbnRDb3VudCsrXG4gICAgICAgICAgICBjb250aW51ZVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghZGV2aWNlLnNlcmlhbE51bWJlciB8fCBkZXZpY2Uuc2VyaWFsTnVtYmVyLmxlbmd0aCA8IDMpIGNvbnRpbnVlO1xuXG4gICAgICAgICAgbGV0IGV4aXN0aW5nRGV2aWNlID0gbnVsbFxuICAgICAgICAgIGlmIChkZXZpY2UuZXF1aXZhbGVudERldmljZUlkKSB7XG4gICAgICAgICAgICBleGlzdGluZ0RldmljZSA9IGF3YWl0IHByaXNtYS5lcXVpdmFsZW50RGV2aWNlLmZpbmRVbmlxdWUoe1xuICAgICAgICAgICAgICB3aGVyZTogeyBpZDogZGV2aWNlLmVxdWl2YWxlbnREZXZpY2VJZCB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghZXhpc3RpbmdEZXZpY2UpIHtcbiAgICAgICAgICAgIGV4aXN0aW5nRGV2aWNlID0gYXdhaXQgcHJpc21hLmVxdWl2YWxlbnREZXZpY2UuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICAgIHdoZXJlOiB7IHNlcmlhbE51bWJlcjogZGV2aWNlLnNlcmlhbE51bWJlciB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChleGlzdGluZ0RldmljZSkge1xuICAgICAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIGRldmljZSBsb2NhdGlvblxuICAgICAgICAgICAgYXdhaXQgcHJpc21hLmVxdWl2YWxlbnREZXZpY2UudXBkYXRlKHtcbiAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IGV4aXN0aW5nRGV2aWNlLmlkIH0sXG4gICAgICAgICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgICAgICAgIGxvY2F0aW9uOiB7IGNvbm5lY3Q6IHsgaWQ6IHRhcmdldExvY2F0aW9uLmlkIH0gfSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRMb2NhdGlvbjogJ0lOX1dBUkVIT1VTRScsXHJcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdBVkFJTEFCTEUnLFxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIC8vIFRyYWNrIEhpc3RvcnlcclxuICAgICAgICAgICAgYXdhaXQgcHJpc21hLmVxdWl2YWxlbnREZXZpY2VIaXN0b3J5LmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgICAgICAgZGV2aWNlOiB7IGNvbm5lY3Q6IHsgaWQ6IGV4aXN0aW5nRGV2aWNlLmlkIH0gfSxcclxuICAgICAgICAgICAgICAgIHByZXZpb3VzTG9jYXRpb246IGV4aXN0aW5nRGV2aWNlLmN1cnJlbnRMb2NhdGlvbixcclxuICAgICAgICAgICAgICAgIG5ld0xvY2F0aW9uOiAnSU5fV0FSRUhPVVNFJyxcclxuICAgICAgICAgICAgICAgIHByZXZpb3VzTG9jYXRpb25JZDogZXhpc3RpbmdEZXZpY2UubG9jYXRpb25JZCxcclxuICAgICAgICAgICAgICAgIG5ld0xvY2F0aW9uSWQ6IHRhcmdldExvY2F0aW9uLmlkLFxyXG4gICAgICAgICAgICAgICAgYXNzaWduZWRUb05hbWU6IGBLYXJnbyBpbGUgR2lyacWfICgke3RyYWNraW5nTnVtYmVyfSlgLFxyXG4gICAgICAgICAgICAgICAgbm90ZXM6IGBHZWxlbiBLYXJnbzogJHt0cmFja2luZ051bWJlcn0gLSBHw7ZuZGVyZW46ICR7c2VuZGVyfSAtIERlcG86ICR7dGFyZ2V0TG9jYXRpb24ubmFtZX1gLFxyXG4gICAgICAgICAgICAgICAgY2hhbmdlZEJ5OiAnU1lTVEVNJyxcbiAgICAgICAgICAgICAgICBjaGFuZ2VkQnlOYW1lOiAnU2lzdGVtIChPdG9tYXRpayBLYXJnbyBHaXJpxZ9pKScsXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIG1vdmVkRXF1aXZhbGVudENvdW50KytcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc2tpcHBlZE5vbkVxdWl2YWxlbnRDb3VudCsrXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1vdmVkRXF1aXZhbGVudENvdW50ID4gMCB8fCBza2lwcGVkTm9uRXF1aXZhbGVudENvdW50ID4gMCkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgYFtjYXJnby1pbmNvbWluZ10gdHJhY2tpbmc9JHt0cmFja2luZ051bWJlcn0gbW92ZWRFcXVpdmFsZW50PSR7bW92ZWRFcXVpdmFsZW50Q291bnR9IHNraXBwZWQ9JHtza2lwcGVkTm9uRXF1aXZhbGVudENvdW50fWBcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhdXRvLWFzc2lnbmluZyBpbmNvbWluZyBjYXJnbyB0byB3YXJlaG91c2U6JywgZXJyKVxuICAgICAgICAvLyBEb24ndCBmYWlsIHRoZSByZXF1ZXN0LCBqdXN0IGxvZyBlcnJvclxuICAgICAgfVxuICAgIH1cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FyZ28sIHsgc3RhdHVzOiAyMDEgfSlcclxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnN0IHAyMDAyVGFyZ2V0ID0gKGVycm9yIGluc3RhbmNlb2YgUHJpc21hLlByaXNtYUNsaWVudEtub3duUmVxdWVzdEVycm9yXG4gICAgICA/IChlcnJvciBhcyBhbnkpLm1ldGE/LnRhcmdldFxuICAgICAgOiBudWxsKVxuICAgIGNvbnN0IHRhcmdldFRleHQgPSBBcnJheS5pc0FycmF5KHAyMDAyVGFyZ2V0KVxuICAgICAgPyBwMjAwMlRhcmdldC5qb2luKCcsJylcbiAgICAgIDogU3RyaW5nKHAyMDAyVGFyZ2V0IHx8ICcnKVxuXG4gICAgaWYgKFxuICAgICAgZXJyb3IgaW5zdGFuY2VvZiBQcmlzbWEuUHJpc21hQ2xpZW50S25vd25SZXF1ZXN0RXJyb3IgJiZcbiAgICAgIGVycm9yLmNvZGUgPT09ICdQMjAwMicgJiZcbiAgICAgIChcbiAgICAgICAgdGFyZ2V0VGV4dC5pbmNsdWRlcygndHJhY2tpbmdfbnVtYmVyJykgfHxcbiAgICAgICAgdGFyZ2V0VGV4dC5pbmNsdWRlcygndHJhY2tpbmdOdW1iZXInKVxuICAgICAgKVxuICAgICkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnQnUgdGFraXAgbnVtYXJhc2kgemF0ZW4ga2F5aXRsaS4gTHV0ZmVuIGZhcmtsaSBiaXIgdGFraXAgbnVtYXJhc2kgZ2lyaW4uJyB9LFxuICAgICAgICB7IHN0YXR1czogNDA5IH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyBjYXJnbzonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGNyZWF0ZSBjYXJnbycgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcclxuICB9XHJcbn1cclxuXHJcblxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicHJpc21hIiwiQ2FyZ29UeXBlIiwiQ2FyZ29TdGF0dXMiLCJDYXJnb0Rlc3RpbmF0aW9uIiwiRGV2aWNlQ29uZGl0aW9uIiwiQ2FyZ29QdXJwb3NlIiwiUHJpc21hIiwiYXBwZW5kQ2FyZ29SZXBhaXJIaXN0b3J5IiwicGFyc2VDYXJnb1JlcGFpck1ldGEiLCJERUZBVUxUX0hRX05BTUUiLCJpc1Vua25vd25SZWNvcmRTdGF0dXNBcmciLCJlcnJvciIsIkVycm9yIiwibWVzc2FnZSIsImluY2x1ZGVzIiwibm9ybWFsaXplUmVjb3JkU3RhdHVzIiwic3RhdHVzIiwibm90ZXMiLCJyYXciLCJ0b0xvd2VyQ2FzZSIsIm1ldGEiLCJhY3RpdmUiLCJnZXRIZWFkcXVhcnRlcnNMb2NhdGlvbiIsImhxIiwibG9jYXRpb24iLCJmaW5kRmlyc3QiLCJ3aGVyZSIsIk9SIiwidHlwZSIsIm5hbWUiLCJjb250YWlucyIsIm9yZGVyQnkiLCJHRVQiLCJyZXF1ZXN0IiwiaGVhZHF1YXJ0ZXJzIiwiaHFOYW1lIiwiY2FyZ29zIiwiY2FyZ29UcmFja2luZyIsImZpbmRNYW55IiwiaW5jbHVkZSIsImRldmljZXMiLCJyZWNvcmRTdGF0dXMiLCJjcmVhdGVkQXQiLCJlbnJpY2hlZCIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJjYXJnbyIsImxvY2F0aW9uTmFtZSIsImxlbmd0aCIsInNlcmlhbHMiLCJkIiwic2VyaWFsTnVtYmVyIiwiZmlsdGVyIiwicyIsIkJvb2xlYW4iLCJkZXZpY2VzSW5TeXN0ZW0iLCJlcXVpdmFsZW50RGV2aWNlIiwiaW4iLCJsb2NhdGlvbnMiLCJTZXQiLCJmb3JFYWNoIiwiYWRkIiwiY3VycmVudExvY2F0aW9uIiwic2l6ZSIsIkFycmF5IiwiZnJvbSIsImN1cnJlbnRMb2NhdGlvbk5hbWUiLCJqc29uIiwiY29uc29sZSIsIlBPU1QiLCJib2R5IiwidHJhY2tpbmdOdW1iZXIiLCJzZW5kZXIiLCJyZWNlaXZlciIsImNhcmdvQ29tcGFueSIsInNlbnREYXRlIiwiZGVsaXZlcmVkRGF0ZSIsImRlc3RpbmF0aW9uIiwiZGVzdGluYXRpb25BZGRyZXNzIiwidHlwZU1hcCIsIklOQ09NSU5HIiwiT1VUR09JTkciLCJPTl9TSVRFX1NFUlZJQ0UiLCJJTlNUQUxMQVRJT05fVEVBTSIsInN0YXR1c01hcCIsIklOX1RSQU5TSVQiLCJERUxJVkVSRUQiLCJSRVRVUk5FRCIsIkxPU1QiLCJEQU1BR0VEIiwiZGVzdGluYXRpb25NYXAiLCJDVVNUT01FUiIsIkRJU1RSSUJVVE9SIiwiQlJBTkNIIiwiSEVBRFFVQVJURVJTIiwiY29uZGl0aW9uTWFwIiwiTkVXIiwiVVNFRCIsIlJFRlVSQklTSEVEIiwicHVycG9zZU1hcCIsIklOU1RBTExBVElPTiIsIlJFUExBQ0VNRU5UIiwiUkVQQUlSIiwiUkVUVVJOIiwicmVjb3JkU3RhdHVzTWFwIiwibm9ybWFsaXplZFRyYWNraW5nTnVtYmVyIiwiU3RyaW5nIiwidHJpbSIsImV4aXN0aW5nQ2FyZ28iLCJmaW5kVW5pcXVlIiwic2VsZWN0IiwiaWQiLCJkZXZpY2VMaXN0IiwiaXNBcnJheSIsInJlc29sdmVkVHlwZSIsImlzSW5jb21pbmciLCJjcmVhdGVEYXRhIiwiRGF0ZSIsImNyZWF0ZSIsImRldmljZSIsImRldmljZU5hbWUiLCJtb2RlbCIsInF1YW50aXR5IiwiY29uZGl0aW9uIiwicHVycG9zZSIsIm1hcHBlZFN0YXR1cyIsImF0IiwidG9JU09TdHJpbmciLCJhY3Rpb24iLCJkYXRhIiwidGFyZ2V0TG9jYXRpb24iLCJ0YXJnZXRMb2NhdGlvbklkIiwiYWRkcmVzcyIsIm1vdmVkRXF1aXZhbGVudENvdW50Iiwic2tpcHBlZE5vbkVxdWl2YWxlbnRDb3VudCIsInNvdXJjZVR5cGUiLCJleGlzdGluZ0RldmljZSIsImVxdWl2YWxlbnREZXZpY2VJZCIsInVwZGF0ZSIsImNvbm5lY3QiLCJlcXVpdmFsZW50RGV2aWNlSGlzdG9yeSIsInByZXZpb3VzTG9jYXRpb24iLCJuZXdMb2NhdGlvbiIsInByZXZpb3VzTG9jYXRpb25JZCIsImxvY2F0aW9uSWQiLCJuZXdMb2NhdGlvbklkIiwiYXNzaWduZWRUb05hbWUiLCJjaGFuZ2VkQnkiLCJjaGFuZ2VkQnlOYW1lIiwibG9nIiwiZXJyIiwicDIwMDJUYXJnZXQiLCJQcmlzbWFDbGllbnRLbm93blJlcXVlc3RFcnJvciIsInRhcmdldCIsInRhcmdldFRleHQiLCJqb2luIiwiY29kZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/cargo/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cargo-repair.ts":
/*!*********************************!*\
  !*** ./src/lib/cargo-repair.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   appendCargoRepairHistory: () => (/* binding */ appendCargoRepairHistory),\n/* harmony export */   parseCargoRepairMeta: () => (/* binding */ parseCargoRepairMeta),\n/* harmony export */   upsertCargoRepairMeta: () => (/* binding */ upsertCargoRepairMeta)\n/* harmony export */ });\nconst META_TAG = \"[[CARGO_REPAIR_META]]\";\nconst defaultMeta = ()=>({\n        active: true,\n        technicianName: \"\",\n        operations: [],\n        imageUrl: \"\",\n        note: \"\",\n        spareParts: [],\n        laborCost: 0,\n        partsCost: 0,\n        totalCost: 0,\n        status: \"pending\",\n        history: [],\n        updatedAt: new Date().toISOString()\n    });\nfunction parseCargoRepairMeta(notes) {\n    const text = (notes || \"\").trim();\n    if (!text.includes(META_TAG)) {\n        return {\n            cleanNotes: text,\n            meta: null\n        };\n    }\n    const lines = text.split(\"\\n\");\n    const clean = [];\n    let meta = null;\n    for (const line of lines){\n        if (!line.startsWith(META_TAG)) {\n            clean.push(line);\n            continue;\n        }\n        const payload = line.slice(META_TAG.length).trim();\n        try {\n            const parsed = JSON.parse(payload);\n            meta = {\n                ...defaultMeta(),\n                ...parsed,\n                history: Array.isArray(parsed?.history) ? parsed.history : [],\n                operations: Array.isArray(parsed?.operations) ? parsed.operations : [],\n                spareParts: Array.isArray(parsed?.spareParts) ? parsed.spareParts : []\n            };\n        } catch  {\n            meta = null;\n        }\n    }\n    return {\n        cleanNotes: clean.join(\"\\n\").trim(),\n        meta\n    };\n}\nfunction upsertCargoRepairMeta(notes, input) {\n    const { cleanNotes, meta } = parseCargoRepairMeta(notes);\n    const next = {\n        ...meta || defaultMeta(),\n        ...input,\n        operations: Array.isArray(input.operations) ? input.operations : meta?.operations || [],\n        spareParts: Array.isArray(input.spareParts) ? input.spareParts : meta?.spareParts || [],\n        history: Array.isArray(input.history) ? input.history : meta?.history || [],\n        updatedAt: new Date().toISOString()\n    };\n    const parts = [\n        cleanNotes,\n        `${META_TAG}${JSON.stringify(next)}`\n    ].filter(Boolean);\n    return parts.join(\"\\n\");\n}\nfunction appendCargoRepairHistory(notes, item, patch) {\n    const { meta } = parseCargoRepairMeta(notes);\n    const base = meta || defaultMeta();\n    const history = [\n        ...base.history,\n        item\n    ];\n    return upsertCargoRepairMeta(notes, {\n        ...patch,\n        history\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1dBQUlvQyxLQUFLcEMsT0FBTztRQUFFa0M7S0FBSztJQUN2QyxPQUFPUixzQkFBc0JyQixPQUFPO1FBQ2xDLEdBQUc4QixLQUFLO1FBQ1JuQztJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZXN0ZWsvLi9zcmMvbGliL2NhcmdvLXJlcGFpci50cz8zNmVhIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBpbnRlcmZhY2UgQ2FyZ29SZXBhaXJIaXN0b3J5SXRlbSB7XG4gIGF0OiBzdHJpbmdcbiAgYWN0aW9uOiBzdHJpbmdcbiAgdGVjaG5pY2lhbk5hbWU/OiBzdHJpbmdcbiAgb3BlcmF0aW9ucz86IHN0cmluZ1tdXG4gIG5vdGU/OiBzdHJpbmdcbiAgbGFib3JDb3N0PzogbnVtYmVyXG4gIHBhcnRzQ29zdD86IG51bWJlclxuICB0b3RhbENvc3Q/OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYXJnb1JlcGFpclNwYXJlUGFydEl0ZW0ge1xuICBuYW1lOiBzdHJpbmdcbiAgcXVhbnRpdHk6IG51bWJlclxuICB1bml0Q29zdDogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FyZ29SZXBhaXJNZXRhIHtcbiAgYWN0aXZlOiBib29sZWFuXG4gIHRlY2huaWNpYW5JZD86IHN0cmluZ1xuICB0ZWNobmljaWFuTmFtZT86IHN0cmluZ1xuICBvcGVyYXRpb25zOiBzdHJpbmdbXVxuICBpbWFnZVVybD86IHN0cmluZ1xuICBub3RlPzogc3RyaW5nXG4gIHNwYXJlUGFydHM6IENhcmdvUmVwYWlyU3BhcmVQYXJ0SXRlbVtdXG4gIGxhYm9yQ29zdD86IG51bWJlclxuICBwYXJ0c0Nvc3Q/OiBudW1iZXJcbiAgdG90YWxDb3N0PzogbnVtYmVyXG4gIHN0YXR1czogJ3BlbmRpbmcnIHwgJ2luX3Byb2dyZXNzJyB8ICdjb21wbGV0ZWQnXG4gIGhpc3Rvcnk6IENhcmdvUmVwYWlySGlzdG9yeUl0ZW1bXVxuICB1cGRhdGVkQXQ6IHN0cmluZ1xufVxuXG5jb25zdCBNRVRBX1RBRyA9ICdbW0NBUkdPX1JFUEFJUl9NRVRBXV0nXG5cbmNvbnN0IGRlZmF1bHRNZXRhID0gKCk6IENhcmdvUmVwYWlyTWV0YSA9PiAoe1xuICBhY3RpdmU6IHRydWUsXG4gIHRlY2huaWNpYW5OYW1lOiAnJyxcbiAgb3BlcmF0aW9uczogW10sXG4gIGltYWdlVXJsOiAnJyxcbiAgbm90ZTogJycsXG4gIHNwYXJlUGFydHM6IFtdLFxuICBsYWJvckNvc3Q6IDAsXG4gIHBhcnRzQ29zdDogMCxcbiAgdG90YWxDb3N0OiAwLFxuICBzdGF0dXM6ICdwZW5kaW5nJyxcbiAgaGlzdG9yeTogW10sXG4gIHVwZGF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxufSlcblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlQ2FyZ29SZXBhaXJNZXRhKG5vdGVzPzogc3RyaW5nIHwgbnVsbCk6IHtcbiAgY2xlYW5Ob3Rlczogc3RyaW5nXG4gIG1ldGE6IENhcmdvUmVwYWlyTWV0YSB8IG51bGxcbn0ge1xuICBjb25zdCB0ZXh0ID0gKG5vdGVzIHx8ICcnKS50cmltKClcbiAgaWYgKCF0ZXh0LmluY2x1ZGVzKE1FVEFfVEFHKSkge1xuICAgIHJldHVybiB7IGNsZWFuTm90ZXM6IHRleHQsIG1ldGE6IG51bGwgfVxuICB9XG5cbiAgY29uc3QgbGluZXMgPSB0ZXh0LnNwbGl0KCdcXG4nKVxuICBjb25zdCBjbGVhbjogc3RyaW5nW10gPSBbXVxuICBsZXQgbWV0YTogQ2FyZ29SZXBhaXJNZXRhIHwgbnVsbCA9IG51bGxcblxuICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aChNRVRBX1RBRykpIHtcbiAgICAgIGNsZWFuLnB1c2gobGluZSlcbiAgICAgIGNvbnRpbnVlXG4gICAgfVxuXG4gICAgY29uc3QgcGF5bG9hZCA9IGxpbmUuc2xpY2UoTUVUQV9UQUcubGVuZ3RoKS50cmltKClcbiAgICB0cnkge1xuICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShwYXlsb2FkKVxuICAgICAgbWV0YSA9IHtcbiAgICAgICAgLi4uZGVmYXVsdE1ldGEoKSxcbiAgICAgICAgLi4ucGFyc2VkLFxuICAgICAgICBoaXN0b3J5OiBBcnJheS5pc0FycmF5KHBhcnNlZD8uaGlzdG9yeSkgPyBwYXJzZWQuaGlzdG9yeSA6IFtdLFxuICAgICAgICBvcGVyYXRpb25zOiBBcnJheS5pc0FycmF5KHBhcnNlZD8ub3BlcmF0aW9ucykgPyBwYXJzZWQub3BlcmF0aW9ucyA6IFtdLFxuICAgICAgICBzcGFyZVBhcnRzOiBBcnJheS5pc0FycmF5KHBhcnNlZD8uc3BhcmVQYXJ0cykgPyBwYXJzZWQuc3BhcmVQYXJ0cyA6IFtdLFxuICAgICAgfVxuICAgIH0gY2F0Y2gge1xuICAgICAgbWV0YSA9IG51bGxcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGNsZWFuTm90ZXM6IGNsZWFuLmpvaW4oJ1xcbicpLnRyaW0oKSxcbiAgICBtZXRhLFxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1cHNlcnRDYXJnb1JlcGFpck1ldGEobm90ZXM6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQsIGlucHV0OiBQYXJ0aWFsPENhcmdvUmVwYWlyTWV0YT4pOiBzdHJpbmcge1xuICBjb25zdCB7IGNsZWFuTm90ZXMsIG1ldGEgfSA9IHBhcnNlQ2FyZ29SZXBhaXJNZXRhKG5vdGVzKVxuICBjb25zdCBuZXh0OiBDYXJnb1JlcGFpck1ldGEgPSB7XG4gICAgLi4uKG1ldGEgfHwgZGVmYXVsdE1ldGEoKSksXG4gICAgLi4uaW5wdXQsXG4gICAgb3BlcmF0aW9uczogQXJyYXkuaXNBcnJheShpbnB1dC5vcGVyYXRpb25zKSA/IGlucHV0Lm9wZXJhdGlvbnMgOiAobWV0YT8ub3BlcmF0aW9ucyB8fCBbXSksXG4gICAgc3BhcmVQYXJ0czogQXJyYXkuaXNBcnJheShpbnB1dC5zcGFyZVBhcnRzKSA/IGlucHV0LnNwYXJlUGFydHMgOiAobWV0YT8uc3BhcmVQYXJ0cyB8fCBbXSksXG4gICAgaGlzdG9yeTogQXJyYXkuaXNBcnJheShpbnB1dC5oaXN0b3J5KSA/IGlucHV0Lmhpc3RvcnkgOiAobWV0YT8uaGlzdG9yeSB8fCBbXSksXG4gICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gIH1cblxuICBjb25zdCBwYXJ0cyA9IFtjbGVhbk5vdGVzLCBgJHtNRVRBX1RBR30ke0pTT04uc3RyaW5naWZ5KG5leHQpfWBdLmZpbHRlcihCb29sZWFuKVxuICByZXR1cm4gcGFydHMuam9pbignXFxuJylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGVuZENhcmdvUmVwYWlySGlzdG9yeShcbiAgbm90ZXM6IHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQsXG4gIGl0ZW06IENhcmdvUmVwYWlySGlzdG9yeUl0ZW0sXG4gIHBhdGNoPzogUGFydGlhbDxDYXJnb1JlcGFpck1ldGE+XG4pOiBzdHJpbmcge1xuICBjb25zdCB7IG1ldGEgfSA9IHBhcnNlQ2FyZ29SZXBhaXJNZXRhKG5vdGVzKVxuICBjb25zdCBiYXNlID0gbWV0YSB8fCBkZWZhdWx0TWV0YSgpXG4gIGNvbnN0IGhpc3RvcnkgPSBbLi4uYmFzZS5oaXN0b3J5LCBpdGVtXVxuICByZXR1cm4gdXBzZXJ0Q2FyZ29SZXBhaXJNZXRhKG5vdGVzLCB7XG4gICAgLi4ucGF0Y2gsXG4gICAgaGlzdG9yeSxcbiAgfSlcbn1cbiJdLCJuYW1lcyI6WyJNRVRBX1RBRyIsImRlZmF1bHRNZXRhIiwiYWN0aXZlIiwidGVjaG5pY2lhbk5hbWUiLCJvcGVyYXRpb25zIiwiaW1hZ2VVcmwiLCJub3RlIiwic3BhcmVQYXJ0cyIsImxhYm9yQ29zdCIsInBhcnRzQ29zdCIsInRvdGFsQ29zdCIsInN0YXR1cyIsImhpc3RvcnkiLCJ1cGRhdGVkQXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJwYXJzZUNhcmdvUmVwYWlyTWV0YSIsIm5vdGVzIiwidGV4dCIsInRyaW0iLCJpbmNsdWRlcyIsImNsZWFuTm90ZXMiLCJtZXRhIiwibGluZXMiLCJzcGxpdCIsImNsZWFuIiwibGluZSIsInN0YXJ0c1dpdGgiLCJwdXNoIiwicGF5bG9hZCIsInNsaWNlIiwibGVuZ3RoIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwiQXJyYXkiLCJpc0FycmF5Iiwiam9pbiIsInVwc2VydENhcmdvUmVwYWlyTWV0YSIsImlucHV0IiwibmV4dCIsInBhcnRzIiwic3RyaW5naWZ5IiwiZmlsdGVyIiwiQm9vbGVhbiIsImFwcGVuZENhcmdvUmVwYWlySGlzdG9yeSIsIml0ZW0iLCJwYXRjaCIsImJhc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cargo-repair.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"query\",\n        \"error\",\n        \"warn\"\n    ]\n});\nif (true) {\n    globalForPrisma.prisma = prisma;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBNkM7QUFFN0MsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBSztRQUFDO1FBQVM7UUFBUztLQUFPO0FBQ2pDLEdBQUU7QUFFRixJQUFJQyxJQUF5QixFQUFjO0lBQ3pDSixnQkFBZ0JFLE1BQU0sR0FBR0E7QUFDM0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZXN0ZWsvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KHtcclxuICBsb2c6IFsncXVlcnknLCAnZXJyb3InLCAnd2FybiddLFxyXG59KVxyXG5cclxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIHtcbiAgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYVxufVxuXHJcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcargo%2Froute&page=%2Fapi%2Fcargo%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcargo%2Froute.ts&appDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CBurak%5CDocuments%5CGitHub%5Cdestek&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();